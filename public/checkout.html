<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - HOT IMPEX</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/styles.css">
    <!-- FontAwesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Theme initialization script -->
    <script>
        const isDarkMode = localStorage.getItem('darkMode') === 'true';
        if (isDarkMode) {
            document.documentElement.classList.add('dark');
        }
    </script>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-50 via-white to-gray-100"></div>
    <!-- Navigation Bar -->
    <header class="fixed top-0 left-0 right-0 z-50 border-b border-white/10 transition-all duration-300">
        <div class="w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-5 lg:py-6">
            <nav class="flex items-center justify-between h-16">
                <!-- Mobile Header with Hot Button and Menu Toggle -->
                <div class="flex items-center justify-between w-full lg:w-auto lg:flex-shrink-0">
                    <!-- Hot Button Section -->
                    <div class="flex-shrink-0">
                        <button class="logo text-gray-800 font-bold py-3 px-6 rounded-full border border-white/30 shadow-2xl hover:bg-white/25 transition-all duration-200 text-xl lg:text-xl bg-white/15 backdrop-blur-3xl">
                            <img id="logo" src="assets/images/logos/logo.png" alt="Hot Impex Logo" class="h-10 w-28 lg:h-12 lg:w-32">
                        </button>
                    </div>

                    <!-- Mobile Menu Toggle Button -->
                    <button id="mobile-menu-toggle" class="lg:hidden text-gray-800 p-3 rounded-full border border-white/30 shadow-2xl transition-all duration-200 bg-white/15 backdrop-blur-3xl hover:bg-white/25">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>

                <!-- Main Navigation Section -->
                <div id="main-nav" class="hidden lg:flex items-center">
                    <div class="rounded-full p-3 flex items-center border border-white/30 shadow-2xl gap-2 bg-white/15 backdrop-blur-3xl">
                        <a href="index.html" class="text-gray-800 px-5 py-2.5 rounded-full hover:bg-white/25 hover:backdrop-blur-sm transition-all duration-200 text-base lg:text-lg font-medium text-center whitespace-nowrap">Home</a>
                        <a href="shop.html" class="text-gray-800 px-5 py-2.5 rounded-full hover:bg-white/25 hover:backdrop-blur-sm transition-all duration-200 text-base lg:text-lg font-medium text-center whitespace-nowrap">Shop</a>
                        <a href="contact.html" class="text-gray-800 px-5 py-2.5 rounded-full hover:bg-white/25 hover:backdrop-blur-sm transition-all duration-200 text-base lg:text-lg font-medium text-center whitespace-nowrap">Contact Us</a>
                        <a href="about.html" class="text-gray-800 px-5 py-2.5 rounded-full hover:bg-white/25 hover:backdrop-blur-sm transition-all duration-200 text-base lg:text-lg font-medium text-center whitespace-nowrap">About Us</a>
                        
                        <!-- Dark Mode Toggle -->
                        <div class="flex items-center justify-center px-4 py-2.5">
                            <div id="theme-toggle" class="theme-toggle" title="Toggle Dark Mode">
                                <svg class="sun-icon absolute top-1 left-1 w-4 h-4 text-yellow-500 transition-opacity duration-300" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
                                </svg>
                                <svg class="moon-icon absolute top-1 right-1 w-4 h-4 text-gray-400 transition-opacity duration-300 opacity-0" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                                </svg>
                            </div>
                        </div>
                        
                        <!-- User Icon with Dropdown -->
                        <div class="relative">
                            <div id="user-dropdown-toggle" class="flex items-center justify-center space-x-1.5 px-4 py-2.5 rounded-full hover:bg-gray-200/50 transition-colors duration-200 cursor-pointer text-base lg:text-lg font-medium whitespace-nowrap">
                                <!-- Simple SVG for user icon -->
                                <svg class="user-icon w-4 h-4" viewBox="0 0 24 24" fill="#374151">
                                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                                </svg>
                                <span id="user-display-name" class="hidden lg:inline text-gray-700 text-base">Account</span>
                                <!-- Dropdown Arrow -->
                                <svg class="w-3.5 h-3.5 text-gray-700 transition-transform duration-200" id="user-dropdown-arrow" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </div>
                            
                            <!-- User Dropdown Menu -->
                            <div id="user-dropdown-menu" class="absolute right-0 mt-2 w-64 bg-white/95 backdrop-blur-md rounded-xl shadow-2xl border border-white/30 py-2 hidden z-50">
                                <!-- Not Logged In State -->
                                <div id="user-not-logged-in" class="px-4 py-3 border-b border-gray-200/50">
                                    <p class="text-sm text-gray-600 mb-3">Sign in to access your account</p>
                                    <div class="space-y-2">
                                        <button id="show-login-modal" class="w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                            Sign In
                                        </button>
                                        <button id="show-register-modal" class="w-full border border-gray-300 hover:bg-gray-50 text-gray-700 font-medium py-2 px-4 rounded-lg transition-colors duration-200">
                                            Create Account
                                        </button>
                                    </div>
                                </div>
                                
                                <!-- Logged In State (Hidden by default) -->
                                <div id="user-logged-in" class="hidden">
                                    <div class="px-4 py-3 border-b border-gray-200/50">
                                        <p class="text-sm font-medium text-gray-900" id="user-welcome">Welcome back!</p>
                                        <p class="text-sm text-gray-600" id="user-email"></p>
                                    </div>
                                    <div class="py-1">
                                        <a href="profile.html" id="user-profile-link" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100/50 transition-colors duration-200">
                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                            </svg>
                                            Profile
                                        </a>
                                        <a href="my-orders.html" id="user-orders-link" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100/50 transition-colors duration-200">
                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l-1 12H6L5 9z"></path>
                                            </svg>
                                            My Orders
                                        </a>
                                        <!-- Admin Panel Link (visible only for admin users) -->
                                        <a href="admin/admin.html" id="admin-panel-link" class="block px-4 py-2 text-sm text-blue-600 hover:bg-blue-50/50 transition-colors duration-200 hidden">
                                            <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                                            </svg>
                                            Admin Panel
                                        </a>
                                        <div class="border-t border-gray-200/50 mt-2 pt-2">
                                            <button id="logout-btn" class="block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50/50 transition-colors duration-200">
                                                <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                                                </svg>
                                                Sign Out
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Shopping Cart Icon with Count -->
                        <div id="cart-toggle" class="flex items-center justify-center space-x-1.5 px-4 py-2.5 rounded-full hover:bg-gray-200/50 transition-colors duration-200 cursor-pointer text-base lg:text-lg font-medium whitespace-nowrap">
                            <!-- Simple SVG for shopping bag icon -->
                            <svg class="user-icon w-4 h-4" viewBox="0 0 24 24" fill="#374151">
                                <path fill-rule="evenodd" d="M7.5 6v.75H5.513c-.96 0-1.763.746-1.858 1.705L2.26 19.99a2.25 2.25 0 002.24 2.51h15.002a2.25 2.25 0 002.24-2.51l-1.395-11.535A1.875 1.875 0 0018.488 6.75H16.5V6a4.5 4.5 0 10-9 0zM15 6.75V6a3 3 0 10-6 0v.75H15z" clip-rule="evenodd" />
                            </svg>
                            <span id="cart-badge" class="bg-orange-500 text-white text-xs font-semibold px-2 py-1 rounded-full" style="display: none;">0</span>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Mobile Menu Overlay -->
    <div id="mobile-menu" class="fixed inset-0 z-50 lg:hidden hidden">
        <div class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div>
        <div class="fixed top-0 right-0 h-full w-80 bg-white/15 backdrop-blur-3xl shadow-2xl transform transition-transform duration-300 ease-in-out border-l border-white/30">
            <div class="p-6">
                <div class="flex justify-between items-center mb-8">
                    <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Menu</h2>
                    <button id="close-mobile-menu" class="text-gray-800 dark:text-white hover:text-orange-400 transition-colors duration-200 p-2 rounded-full bg-white/20 backdrop-blur-sm border border-white/30">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                <nav class="space-y-6">
                    <ul class="space-y-4">
                        <li><a href="index.html" class="block py-3 px-4 rounded-lg hover:bg-white/25 hover:backdrop-blur-sm text-gray-800 dark:text-white transition-all duration-200 border border-white/20">Home</a></li>
                        <li><a href="shop.html" class="block py-3 px-4 rounded-lg hover:bg-white/25 hover:backdrop-blur-sm text-gray-800 dark:text-white transition-all duration-200 border border-white/20">Shop</a></li>
                        <li><a href="contact.html" class="block py-3 px-4 rounded-lg hover:bg-white/25 hover:backdrop-blur-sm text-gray-800 dark:text-white transition-all duration-200 border border-white/20">Contact Us</a></li>
                        <li><a href="about.html" class="block py-3 px-4 rounded-lg hover:bg-white/25 hover:backdrop-blur-sm text-gray-800 dark:text-white transition-all duration-200 border border-white/20">About Us</a></li>
                        <li>
                            <a href="profile.html" id="mobile-profile-link" class="block py-3 px-4 rounded-lg hover:bg-white/25 hover:backdrop-blur-sm text-gray-800 dark:text-white transition-all duration-200 border border-white/20">
                                <div class="flex items-center space-x-3">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                                    </svg>
                                    <span>My Profile</span>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="my-orders.html" id="mobile-orders-link" class="block py-3 px-4 rounded-lg hover:bg-white/25 hover:backdrop-blur-sm text-gray-800 dark:text-white transition-all duration-200 border border-white/20">
                                <div class="flex items-center space-x-3">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l-1 12H6L5 9z"></path>
                                    </svg>
                                    <span>My Orders</span>
                                </div>
                            </a>
                        </li>
                        <li>
                            <button id="mobile-cart-toggle" class="block w-full py-3 px-4 rounded-lg hover:bg-white/25 hover:backdrop-blur-sm text-gray-800 dark:text-white transition-all duration-200 border border-white/20 text-left">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center space-x-3">
                                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="currentColor">
                                            <path fill-rule="evenodd" d="M7.5 6v.75H5.513c-.96 0-1.763.746-1.858 1.705L2.26 19.99a2.25 2.25 0 002.24 2.51h15.002a2.25 2.25 0 002.24-2.51l-1.395-11.535A1.875 1.875 0 0018.488 6.75H16.5V6a4.5 4.5 0 10-9 0zM15 6.75V6a3 3 0 10-6 0v.75H15z" clip-rule="evenodd" />
                                        </svg>
                                        <span>Shopping Cart</span>
                                    </div>
                                    <span id="mobile-cart-badge" class="bg-orange-500 text-white text-xs font-semibold px-2 py-1 rounded-full" style="display: none;">0</span>
                                </div>
                            </button>
                        </li>
                        <li class="border-t border-white/20 pt-4 mt-4">
                            <button id="mobile-login-btn" class="block w-full py-3 px-4 rounded-lg bg-gradient-to-r from-orange-500 to-pink-500 text-white font-medium transition-all duration-200 hover:shadow-lg hover:scale-105" style="display: none;">
                                <div class="flex items-center justify-center space-x-3">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
                                    </svg>
                                    <span>Sign In / Register</span>
                                </div>
                            </button>
                            <button id="mobile-logout-btn" class="block w-full py-3 px-4 rounded-lg bg-red-500 text-white font-medium transition-all duration-200 hover:bg-red-600 hover:shadow-lg" style="display: none;">
                                <div class="flex items-center justify-center space-x-3">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
                                    </svg>
                                    <span>Sign Out</span>
                                </div>
                            </button>
                        </li>
                    </ul>
                    <div class="mt-8 pt-8 border-t border-white/30">
                        <div class="flex items-center justify-between p-4 rounded-lg bg-white/20 backdrop-blur-sm border border-white/30">
                            <span class="text-gray-800 dark:text-white font-medium">Dark Mode</span>
                            <div id="mobile-theme-toggle" class="theme-toggle">
                                <svg class="sun-icon w-5 h-5 text-yellow-500 transition-opacity duration-300" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z" clip-rule="evenodd"></path>
                                </svg>
                                <svg class="moon-icon w-5 h-5 text-gray-400 transition-opacity duration-300 opacity-0" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path>
                                </svg>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 z-50 hidden">
        <div class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div>
        <div class="fixed inset-0 flex items-center justify-center p-4">
            <div class="bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 w-full max-w-md p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Sign In</h2>
                    <button id="close-login-modal" class="text-gray-500 hover:text-gray-700 transition-colors duration-200">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <form id="login-form" class="space-y-6">
                    <div>
                        <label for="login-email" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="login-email" name="email" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200"
                               placeholder="Enter your email">
                    </div>
                    
                    <div>
                        <label for="login-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <div class="relative">
                            <input type="password" id="login-password" name="password" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200"
                                   placeholder="Enter your password">
                            <button type="button" id="toggle-login-password" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex items-center justify-between">
                        <label class="flex items-center">
                            <input type="checkbox" class="rounded border-gray-300 text-orange-600 focus:ring-orange-500">
                            <span class="ml-2 text-sm text-gray-600">Remember me</span>
                        </label>
                        <a href="#" class="text-sm text-orange-600 hover:text-orange-500">Forgot password?</a>
                    </div>
                    
                    <button type="submit" 
                            class="w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 focus:ring-2 focus:ring-orange-500 focus:ring-offset-2">
                        Sign In
                    </button>
                    
                    <div class="text-center">
                        <span class="text-sm text-gray-600">Don't have an account? </span>
                        <button type="button" id="switch-to-register" class="text-sm text-orange-600 hover:text-orange-500 font-medium">
                            Create one
                        </button>
                    </div>
                </form>
                
                <div id="login-error" class="hidden mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
                    <p class="text-red-600 text-sm"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="fixed inset-0 z-50 hidden">
        <div class="fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm"></div>
        <div class="fixed inset-0 flex items-center justify-center p-4">
            <div class="bg-white/95 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 w-full max-w-md p-8">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-gray-900">Create Account</h2>
                    <button id="close-register-modal" class="text-gray-500 hover:text-gray-700 transition-colors duration-200">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <form id="register-form" class="space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label for="register-firstName" class="block text-sm font-medium text-gray-700 mb-2">First Name</label>
                            <input type="text" id="register-firstName" name="firstName" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200"
                                   placeholder="First name">
                        </div>
                        <div>
                            <label for="register-lastName" class="block text-sm font-medium text-gray-700 mb-2">Last Name</label>
                            <input type="text" id="register-lastName" name="lastName" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200"
                                   placeholder="Last name">
                        </div>
                    </div>
                    
                    <div>
                        <label for="register-email" class="block text-sm font-medium text-gray-700 mb-2">Email</label>
                        <input type="email" id="register-email" name="email" required 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200"
                               placeholder="Enter your email">
                    </div>
                    
                    <div>
                        <label for="register-phone" class="block text-sm font-medium text-gray-700 mb-2">Phone Number</label>
                        <input type="tel" id="register-phone" name="phone" 
                               class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200"
                               placeholder="Enter your phone number">
                    </div>
                    
                    <div>
                        <label for="register-password" class="block text-sm font-medium text-gray-700 mb-2">Password</label>
                        <div class="relative">
                            <input type="password" id="register-password" name="password" required 
                                   class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-colors duration-200"
                                   placeholder="Create a password">
                            <button type="button" id="toggle-register-password" class="absolute inset-y-0 right-0 pr-3 flex items-center">
                                <svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>
                                </svg>
                            </button>
                        </div>
                        <p class="mt-1 text-xs text-gray-500">Minimum 8 characters</p>
                    </div>
                    
                    <div>
                        <label class="flex items-center">
                            <input type="checkbox" id="register-terms" required class="rounded border-gray-300 text-orange-600 focus:ring-orange-500">
                            <span class="ml-2 text-sm text-gray-600">
                                I agree to the <a href="#" class="text-orange-600 hover:text-orange-500">Terms of Service</a> 
                                and <a href="#" class="text-orange-600 hover:text-orange-500">Privacy Policy</a>
                            </span>
                        </label>
                    </div>
                    
                    <button type="submit" 
                            class="w-full bg-orange-500 hover:bg-orange-600 text-white font-medium py-3 px-4 rounded-lg transition-colors duration-200 focus:ring-2 focus:ring-orange-500 focus:ring-offset-2">
                        Create Account
                    </button>
                    
                    <div class="text-center">
                        <span class="text-sm text-gray-600">Already have an account? </span>
                        <button type="button" id="switch-to-login" class="text-sm text-orange-600 hover:text-orange-500 font-medium">
                            Sign in
                        </button>
                    </div>
                </form>
                
                <div id="register-error" class="hidden mt-4 p-3 bg-red-50 border border-red-200 rounded-lg">
                    <p class="text-red-600 text-sm"></p>
                </div>
                
                <div id="register-success" class="hidden mt-4 p-3 bg-green-50 border border-green-200 rounded-lg">
                    <p class="text-green-600 text-sm"></p>
                </div>
            </div>
        </div>
    </div>

    <!-- Breadcrumb -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6" style="margin-top: 120px;">
        <nav class="flex mb-8" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-3 text-sm bg-white/60 backdrop-blur-sm rounded-full px-6 py-3 shadow-lg border border-white/20">
                <li><a href="index.html" class="text-gray-600 hover:text-purple-600 font-medium transition-colors duration-200">Home</a></li>
                <li><span class="text-gray-400">•</span></li>
                <li><a href="shop.html" class="text-gray-600 hover:text-purple-600 font-medium transition-colors duration-200">Shop</a></li>
                <li><span class="text-gray-400">•</span></li>
                <li><span class="text-gray-900 font-semibold">Checkout</span></li>
            </ol>
        </nav>
    </div>

    <!-- Main Checkout Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-12">
        <div class="text-center mb-8">
            <h1 class="text-4xl sm:text-5xl font-black text-gray-800 tracking-tight mb-4">
                Checkout
            </h1>
            <div class="w-32 h-1 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full mx-auto"></div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Left Side - Checkout Form -->
            <div class="lg:col-span-2 space-y-8">
                <!-- Shipping Information -->
                <div class="bg-gradient-to-br from-white to-gray-50 rounded-3xl shadow-2xl p-8 border border-gray-200">
                    <div class="flex items-center mb-6">
                        <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl mr-4 flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800">Shipping Information</h2>
                    </div>

                    <form id="checkout-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="firstName" class="block text-sm font-semibold text-gray-700 mb-2">First Name *</label>
                                <input type="text" id="firstName" name="firstName" required 
                                       class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                            </div>
                            <div>
                                <label for="lastName" class="block text-sm font-semibold text-gray-700 mb-2">Last Name *</label>
                                <input type="text" id="lastName" name="lastName" required 
                                       class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                            </div>
                        </div>

                        <div>
                            <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">Email Address *</label>
                            <input type="email" id="email" name="email" required 
                                   class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                        </div>

                        <div>
                            <label for="phone" class="block text-sm font-semibold text-gray-700 mb-2">Phone Number *</label>
                            <input type="tel" id="phone" name="phone" required 
                                   class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                        </div>

                        <div>
                            <label for="address" class="block text-sm font-semibold text-gray-700 mb-2">Street Address *</label>
                            <input type="text" id="address" name="address" required 
                                   class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label for="city" class="block text-sm font-semibold text-gray-700 mb-2">City *</label>
                                <input type="text" id="city" name="city" required 
                                       class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                            </div>
                            <div>
                                <label for="state" class="block text-sm font-semibold text-gray-700 mb-2">State/Province *</label>
                                <input type="text" id="state" name="state" required 
                                       class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                            </div>
                            <div>
                                <label for="zipCode" class="block text-sm font-semibold text-gray-700 mb-2">ZIP Code *</label>
                                <input type="text" id="zipCode" name="zipCode" required 
                                       class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                            </div>
                        </div>

                        <div>
                            <label for="country" class="block text-sm font-semibold text-gray-700 mb-2">Country *</label>
                            <select id="country" name="country" required 
                                    class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm">
                                <option value="">Select Country</option>
                                <option value="EG">Egypt</option>
                                <option value="SA">Saudi Arabia</option>
                                <option value="AE">United Arab Emirates</option>
                                <option value="JO">Jordan</option>
                                <option value="LB">Lebanon</option>
                                <option value="SY">Syria</option>
                                <option value="IQ">Iraq</option>
                                <option value="KW">Kuwait</option>
                                <option value="QA">Qatar</option>
                                <option value="BH">Bahrain</option>
                                <option value="OM">Oman</option>
                                <option value="YE">Yemen</option>
                                <option value="PS">Palestine</option>
                                <option value="MA">Morocco</option>
                                <option value="TN">Tunisia</option>
                                <option value="DZ">Algeria</option>
                                <option value="LY">Libya</option>
                                <option value="SD">Sudan</option>
                                <option value="SO">Somalia</option>
                                <option value="DJ">Djibouti</option>
                                <option value="KM">Comoros</option>
                                <option value="MR">Mauritania</option>
                            </select>
                        </div>

                        <div>
                            <label for="notes" class="block text-sm font-semibold text-gray-700 mb-2">Order Notes (Optional)</label>
                            <textarea id="notes" name="notes" rows="3" 
                                      class="w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-purple-500 focus:ring-4 focus:ring-purple-200 transition-all duration-300 bg-white/50 backdrop-blur-sm"
                                      placeholder="Any special instructions for your order..."></textarea>
                        </div>
                    </form>
                </div>

                <!-- Payment Method -->
                <div class="bg-gradient-to-br from-white to-gray-50 rounded-3xl shadow-2xl p-8 border border-gray-200">
                    <div class="flex items-center mb-6">
                        <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-500 rounded-xl mr-4 flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800">Payment Method</h2>
                    </div>

                    <div class="space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Cash on Delivery Option (Default) -->
                            <label class="payment-option cursor-pointer">
                                <input type="radio" name="paymentMethod" value="cod" class="sr-only" checked>
                                <div class="payment-card border-2 border-green-500 bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-6 transition-all duration-300 hover:shadow-lg">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-10 h-10 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center">
                                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <h3 class="font-bold text-gray-800">Cash on Delivery</h3>
                                            <p class="text-sm text-gray-600">Pay when you receive</p>
                                        </div>
                                    </div>
                                </div>
                            </label>

                            <!-- Credit Card Option (Coming Soon) -->
                            <label class="payment-option cursor-not-allowed opacity-60">
                                <input type="radio" name="paymentMethod" value="card" class="sr-only" disabled>
                                <div class="payment-card border-2 border-gray-300 bg-gray-100 rounded-xl p-6 transition-all duration-300">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-10 h-10 bg-gradient-to-r from-gray-400 to-gray-500 rounded-lg flex items-center justify-center">
                                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
                                            </svg>
                                        </div>
                                        <div>
                                            <h3 class="font-bold text-gray-600">Credit/Debit Card</h3>
                                            <p class="text-sm text-gray-500">Coming Soon</p>
                                        </div>
                                    </div>
                                    <div class="mt-3 bg-yellow-100 border border-yellow-300 rounded-lg p-2">
                                        <p class="text-xs text-yellow-700 font-medium">Online payment will be available soon!</p>
                                    </div>
                                </div>
                            </label>
                        </div>

                        <!-- Credit Card Form (initially hidden) -->
                        <div id="card-form" class="card-details hidden space-y-4 bg-gray-50 rounded-xl p-6">
                            <div class="bg-yellow-100 border border-yellow-300 rounded-lg p-4 mb-4">
                                <div class="flex items-center space-x-2">
                                    <svg class="w-5 h-5 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                    </svg>
                                    <p class="text-sm font-medium text-yellow-800">Online payment will be available soon!</p>
                                </div>
                                <p class="text-xs text-yellow-700 mt-1">For now, please use Cash on Delivery option.</p>
                            </div>
                            <div>
                                <label for="cardNumber" class="block text-sm font-semibold text-gray-700 mb-2">Card Number *</label>
                                <input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456" disabled
                                       class="w-full px-4 py-3 rounded-xl border border-gray-300 bg-gray-100 cursor-not-allowed transition-all duration-300">
                            </div>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <label for="cardExpiry" class="block text-sm font-semibold text-gray-700 mb-2">Expiry Date *</label>
                                    <input type="text" id="cardExpiry" name="cardExpiry" placeholder="MM/YY" disabled
                                           class="w-full px-4 py-3 rounded-xl border border-gray-300 bg-gray-100 cursor-not-allowed transition-all duration-300">
                                </div>
                                <div>
                                    <label for="cardCVV" class="block text-sm font-semibold text-gray-700 mb-2">CVV *</label>
                                    <input type="text" id="cardCVV" name="cardCVV" placeholder="123" disabled
                                           class="w-full px-4 py-3 rounded-xl border border-gray-300 bg-gray-100 cursor-not-allowed transition-all duration-300">
                                </div>
                            </div>
                            <div>
                                <label for="cardName" class="block text-sm font-semibold text-gray-700 mb-2">Cardholder Name *</label>
                                <input type="text" id="cardName" name="cardName" placeholder="John Doe" disabled
                                       class="w-full px-4 py-3 rounded-xl border border-gray-300 bg-gray-100 cursor-not-allowed transition-all duration-300">
                            </div>
                        </div>

                        <!-- Cash on Delivery Info (initially visible) -->
                        <div id="cod-info" class="card-details bg-green-50 rounded-xl p-6">
                            <div class="flex items-center space-x-3 mb-4">
                                <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                </svg>
                                <div>
                                    <h4 class="font-bold text-green-800">Cash on Delivery Selected</h4>
                                    <p class="text-sm text-green-600">You will pay when your order is delivered to your address.</p>
                                </div>
                            </div>
                            <div class="bg-white rounded-lg p-4 border border-green-200">
                                <h5 class="font-semibold text-gray-800 mb-2">Important Notes:</h5>
                                <ul class="text-sm text-gray-600 space-y-1">
                                    <li>• Please have exact change ready</li>
                                    <li>• Delivery fee may apply</li>
                                    <li>• Orders may take 2-5 business days</li>
                                    <li>• Payment is required upon delivery</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Side - Order Summary -->
            <div class="lg:col-span-1">
                <div class="bg-gradient-to-br from-white to-gray-50 rounded-3xl shadow-2xl p-8 border border-gray-200 lg:sticky lg:top-32">
                    <div class="flex items-center mb-6">
                        <div class="w-10 h-10 bg-gradient-to-r from-orange-500 to-red-500 rounded-xl mr-4 flex items-center justify-center">
                            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                            </svg>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800">Order Summary</h2>
                    </div>

                    <!-- Cart Items -->
                    <div id="checkout-cart-items" class="space-y-4 mb-6">
                        <!-- Cart items will be populated by JavaScript -->
                        <div class="text-center text-gray-500 py-8">
                            <svg class="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                            </svg>
                            <p class="text-lg font-semibold">Your cart is empty</p>
                            <p class="text-sm mt-2">Add items to see them here.</p>
                            <a href="shop.html" class="inline-block mt-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white py-2 px-6 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-300">
                                Continue Shopping
                            </a>
                        </div>
                    </div>

                    <!-- Order Totals -->
                    <div id="order-totals" class="space-y-3 border-t border-gray-200 pt-6 hidden">
                        <div class="flex justify-between text-gray-700">
                            <span>Subtotal:</span>
                            <span id="checkout-subtotal">0 EGP</span>
                        </div>
                        <div class="flex justify-between text-gray-700">
                            <span>Shipping:</span>
                            <span id="checkout-shipping">Free</span>
                        </div>
                        <div class="flex justify-between text-gray-700">
                            <span>Tax:</span>
                            <span id="checkout-tax">0 EGP</span>
                        </div>
                        <div class="border-t border-gray-200 pt-3">
                            <div class="flex justify-between text-xl font-bold text-gray-800">
                                <span>Total:</span>
                                <span id="checkout-total">0 EGP</span>
                            </div>
                        </div>
                    </div>

                    <!-- Place Order Button -->
                    <button id="place-order-btn" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-4 px-6 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-purple-300 font-bold text-lg mt-6 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                        <div class="flex items-center justify-center space-x-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                            </svg>
                            <span>Place Order</span>
                        </div>
                    </button>

                    <!-- Security Info -->
                    <div class="mt-6 bg-green-50 rounded-xl p-4 border border-green-200">
                        <div class="flex items-center space-x-2 mb-2">
                            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                            </svg>
                            <span class="font-semibold text-green-800">Secure Checkout</span>
                        </div>
                        <p class="text-sm text-green-600">Your payment information is encrypted and secure. We never store your payment details.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-3xl shadow-2xl max-w-md w-full p-8 transform scale-95 transition-transform duration-300">
            <div class="text-center">
                <div class="w-20 h-20 bg-gradient-to-r from-green-500 to-emerald-500 rounded-full mx-auto mb-6 flex items-center justify-center">
                    <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Order Placed Successfully!</h3>
                <p class="text-gray-600 mb-6">Thank you for your order. You will receive a confirmation email shortly.</p>
                <div class="space-y-3">
                    <p class="text-sm text-gray-500">Order Number: <span id="order-number" class="font-semibold text-gray-800">#12345</span></p>
                    <div class="flex space-x-3">
                        <button onclick="closeSuccessModal()" class="flex-1 bg-gray-200 text-gray-800 py-3 px-6 rounded-xl hover:bg-gray-300 transition-colors duration-300 font-semibold">
                            Continue Shopping
                        </button>
                        <button onclick="window.location.href='index.html'" class="flex-1 bg-gradient-to-r from-purple-600 to-pink-600 text-white py-3 px-6 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-300 font-semibold">
                            Go Home
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="w-full bg-gray-800 text-gray-300 py-10 sm:py-12 lg:py-16 mt-12 sm:mt-16 lg:mt-20">
        <div class="max-w-7xl mx-auto px-6 flex flex-col md:flex-row justify-between items-center md:items-start space-y-8 md:space-y-0 text-center md:text-left">
            <div class="flex flex-col items-center md:items-start">
                <img src="assets/images/logos/logo-light.svg" alt="Hot Impex Logo" class="h-12 w-40 mb-4">
                <p class="text-gray-400 max-w-md">Professional AV solutions and high-quality electronics for businesses and consumers.</p>
            </div>
            <div class="flex flex-col items-center md:items-start space-y-3">
                <h4 class="text-lg font-semibold text-white">Quick Links</h4>
                <a href="index.html" class="text-gray-400 hover:text-white transition-colors duration-200">Home</a>
                <a href="shop.html" class="text-gray-400 hover:text-white transition-colors duration-200">Shop</a>
                <a href="about.html" class="text-gray-400 hover:text-white transition-colors duration-200">About</a>
                <a href="contact.html" class="text-gray-400 hover:text-white transition-colors duration-200">Contact</a>
            </div>
            <div class="flex flex-col items-center md:items-start space-y-3">
                <h4 class="text-lg font-semibold text-white">Follow Us</h4>
                <div class="flex space-x-4">
                    <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">
                        <i class="fab fa-facebook-f"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">
                        <i class="fab fa-twitter"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">
                        <i class="fab fa-instagram"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-colors duration-200">
                        <i class="fab fa-linkedin-in"></i>
                    </a>
                </div>
            </div>
        </div>
        <div class="max-w-7xl mx-auto px-6 mt-8 pt-8 border-t border-gray-700 text-center text-gray-400">
            <p>&copy; 2025 Hot Impex. All rights reserved.</p>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="assets/js/scripts.js"></script>
    
    <!-- Checkout Page Initialization -->
    <script>
        // Debug function to check cart status
        function debugCartStatus() {
            console.log('=== CART DEBUG STATUS ===');
            console.log('window.cart:', window.cart);
            console.log('localStorage hotimpex-guest-cart:', localStorage.getItem('hotimpex-guest-cart'));
            console.log('getCartForCheckout available:', typeof window.getCartForCheckout);
            if (window.getCartForCheckout) {
                console.log('getCartForCheckout result:', window.getCartForCheckout());
            }
            console.log('AuthService available:', typeof window.AuthService);
            if (window.AuthService) {
                console.log('User logged in:', window.AuthService.isLoggedIn());
            }
            console.log('CartService available:', typeof window.CartService);
            console.log('=== END CART DEBUG ===');
        }
        
        // Make debug function globally available
        window.debugCartStatus = debugCartStatus;
        
        // Wait for scripts.js to fully load before initializing checkout
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Checkout page initializing...');
            
            // Wait for scripts.js to initialize global variables and CartService
            function initializeCheckoutWhenReady() {
                if (window.CartService && window.getCartForCheckout) {
                    // Initialize checkout cart
                    loadCheckoutCart();
                    
                    // Load user data and prefill form
                    loadUserData();
                    
                    // Initialize payment method toggle and other checkout-specific functionality
                    setupPaymentMethodToggle();
                    
                    console.log('Checkout page initialized successfully');
                } else {
                    setTimeout(initializeCheckoutWhenReady, 100);
                }
            }
            
            initializeCheckoutWhenReady();
        });
    </script>
    
    <!-- Simple CSS fix for scroll -->
    <style>
        /* Prevent horizontal scroll */
        html, body {
            overflow-x: hidden;
        }
        
        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Fix sticky positioning */
        .lg\:sticky {
            position: sticky;
        }
        
        /* Disable sticky on mobile */
        @media (max-width: 1023px) {
            .lg\:sticky {
                position: static !important;
            }
        }
    </style>
    
    <script>
        // Checkout page specific JavaScript - secondary initialization
        document.addEventListener('DOMContentLoaded', function() {
            // These functions are called after the main initialization above
            setupFormValidation();
            setupMobileMenu();
            setupThemeToggle();
        });

        // Load user data and prefill form
        async function loadUserData() {
            try {
                const user = AuthService?.getUser();
                const token = AuthService?.getToken();
                
                if (token && user) {
                    // Try to get fresh user data from server
                    try {
                        if (window.AuthService && typeof AuthService.getCurrentUser === 'function') {
                            const freshUserData = await AuthService.getCurrentUser();
                            
                            if (freshUserData && freshUserData.data && freshUserData.data.user) {
                                prefillUserForm(freshUserData.data.user);
                            } else if (user) {
                                // Fallback to cached user data
                                prefillUserForm(user);
                            }
                        } else {
                            prefillUserForm(user);
                        }
                    } catch (error) {
                        console.error('Error fetching fresh user data:', error);
                        // Fallback to cached user data
                        if (user) {
                            prefillUserForm(user);
                        }
                    }
                }
            } catch (error) {
                console.error('Error in loadUserData:', error);
            }
        }

        // Prefill form with user data
        function prefillUserForm(user) {
            try {
                // Basic user information
                if (user.firstName) {
                    const firstNameField = document.getElementById('firstName');
                    if (firstNameField) {
                        firstNameField.value = user.firstName;
                    }
                }
                
                if (user.lastName) {
                    const lastNameField = document.getElementById('lastName');
                    if (lastNameField) {
                        lastNameField.value = user.lastName;
                    }
                }
                
                if (user.email) {
                    const emailField = document.getElementById('email');
                    if (emailField) {
                        emailField.value = user.email;
                    }
                }
                
                if (user.phone) {
                    const phoneField = document.getElementById('phone');
                    if (phoneField) {
                        phoneField.value = user.phone;
                    }
                }
                
                // Address information
                if (user.address) {
                    const addressField = document.getElementById('address');
                    if (addressField) {
                        addressField.value = user.address;
                    }
                }
                
                if (user.city) {
                    const cityField = document.getElementById('city');
                    if (cityField) cityField.value = user.city;
                }
                
                if (user.state) {
                    const stateField = document.getElementById('state');
                    if (stateField) stateField.value = user.state;
                }
                
                if (user.zipCode) {
                    const zipField = document.getElementById('zipCode');
                    if (zipField) zipField.value = user.zipCode;
                }
                
                if (user.country) {
                    const countryField = document.getElementById('country');
                    if (countryField) countryField.value = user.country;
                }
                
                console.log('Form prefilled successfully');
                
                // Show a notification that data was loaded
                showNotification('Your profile information has been loaded', 'success');
                
            } catch (error) {
                console.error('Error prefilling form:', error);
            }
        }
        // Enhanced cart loading for checkout
        async function loadCheckoutCart() {
            console.log('=== CHECKOUT CART LOADING ===');
            
            let cart = [];
            
            // First ensure CartService is loaded and cart is initialized
            if (window.CartService) {
                try {
                    // Load the appropriate cart based on user status
                    if (window.AuthService && window.AuthService.isLoggedIn()) {
                        cart = await window.CartService.loadUserCart();
                        console.log('Loaded user cart from service:', cart);
                    } else {
                        cart = window.CartService.loadGuestCart();
                        console.log('Loaded guest cart from service:', cart);
                    }
                } catch (error) {
                    console.error('Error loading cart from CartService:', error);
                }
            }
            
            // Use getCartForCheckout if available and cart is still empty
            if (cart.length === 0 && window.getCartForCheckout) {
                cart = await window.getCartForCheckout();
            } else if (window.getCartForCheckout) {
                // Even if we have a cart, process it through getCartForCheckout for normalization
                cart = await window.getCartForCheckout();
            }
            
            // Fallback to direct storage access if needed
            if (cart.length === 0) {
                cart = loadGuestCartFromStorage();
                console.log('Fallback: loaded from storage:', cart);
            }
            
            processCheckoutCart(cart);
        }
        
        function loadGuestCartFromStorage() {
            let cart = [];
            
            // Try the new guest cart key first
            const guestCart = localStorage.getItem('hotimpex-guest-cart');
            if (guestCart) {
                try {
                    cart = JSON.parse(guestCart);
                    console.log('Loaded guest cart from hotimpex-guest-cart:', cart);
                } catch (e) {
                    console.error('Error parsing guest cart:', e);
                }
            }
            
            // Fallback to old cart keys for migration only
            if (cart.length === 0) {
                const oldCart1 = localStorage.getItem('hotimpex-cart');
                const oldCart2 = localStorage.getItem('hotimpex_cart');
                
                if (oldCart1) {
                    try {
                        cart = JSON.parse(oldCart1);
                        console.log('Migrated cart from hotimpex-cart:', cart);
                        // Migrate to new structure
                        localStorage.setItem('hotimpex-guest-cart', oldCart1);
                        localStorage.removeItem('hotimpex-cart');
                    } catch (e) {
                        console.error('Error parsing old cart:', e);
                    }
                } else if (oldCart2) {
                    try {
                        cart = JSON.parse(oldCart2);
                        console.log('Migrated cart from hotimpex_cart:', cart);
                        // Migrate to new structure
                        localStorage.setItem('hotimpex-guest-cart', oldCart2);
                        localStorage.removeItem('hotimpex_cart');
                    } catch (e) {
                        console.error('Error parsing old cart:', e);
                    }
                }
            }
            
            return cart;
        }
        
        function processCheckoutCart(cart) {
            console.log('=== PROCESSING CHECKOUT CART ===');
            console.log('Cart to process:', cart);
            console.log('Cart length:', cart.length);
            
            const cartItemsContainer = document.getElementById('checkout-cart-items');
            const orderTotals = document.getElementById('order-totals');
            const placeOrderBtn = document.getElementById('place-order-btn');

            if (cart.length === 0) {
                placeOrderBtn.disabled = true;
                orderTotals.classList.add('hidden');
                
                // Show empty cart message
                cartItemsContainer.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        <svg class="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <p class="text-lg font-semibold">Your cart is empty</p>
                        <p class="text-sm mt-2">Add items to see them here.</p>
                        <a href="shop.html" class="inline-block mt-4 bg-gradient-to-r from-purple-600 to-pink-600 text-white py-2 px-6 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-300">
                            Continue Shopping
                        </a>
                    </div>
                `;
                return;
            }

            // Show order totals and enable place order button
            orderTotals.classList.remove('hidden');
            placeOrderBtn.disabled = false;

            // Clear existing items
            cartItemsContainer.innerHTML = '';

            let subtotal = 0;

            cart.forEach((item, index) => {
                console.log(`=== PROCESSING ITEM ${index} ===`);
                console.log('Item data:', item);
                console.log('Item name:', item.name);
                console.log('Item price:', item.price);
                console.log('Item quantity:', item.quantity);
                
                // Ensure we have valid data
                const itemPrice = parseFloat(item.price) || 0;
                const itemQuantity = parseInt(item.quantity) || 1;
                const itemTotal = itemPrice * itemQuantity;
                subtotal += itemTotal;

                // Determine the correct image to use
                const imageUrl = item.mainImage || item.image || 'assets/images/placeholder.jpg';
                console.log(`Item ${index} final data:`, {
                    name: item.name || 'Unknown Product',
                    price: itemPrice,
                    quantity: itemQuantity,
                    total: itemTotal,
                    image: imageUrl
                });
                
                // Handle image error - create a fallback with better styling
                const imgError = "this.onerror=null; this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHZpZXdCb3g9IjAgMCA2NCA2NCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSIjRjNGNEY2Ii8+CjxwYXRoIGQ9Ik0yMiAyMkgzMlYzMkgyMlYyMloiIGZpbGw9IiM5Q0EzQUYiLz4KPHBhdGggZD0iTTM0IDI0SzQyVjMySDM0VjI0WiIgZmlsbD0iIzlDQTNBRiIvPgo8cGF0aCBkPSJNMjIgMzRIMzJWNDJIMjJWMzRaIiBmaWxsPSIjOUNBM0FGIi8+CjxwYXRoIGQ9Ik0zNCAzNEg0MlY0MkgzNFYzNFoiIGZpbGw9IiM5Q0EzQUYiLz4KPC9zdmc+'; this.style.objectFit='contain';";
                
                const cartItemHTML = `
                    <div class="flex items-center space-x-4 p-4 bg-gray-50 rounded-xl border border-gray-200 hover:border-purple-300 transition-colors duration-200">
                        <div class="w-16 h-16 flex-shrink-0 bg-gray-100 rounded-lg border border-gray-200 overflow-hidden">
                            <img src="${imageUrl}" 
                                 alt="${item.name || 'Product'}" 
                                 class="w-full h-full object-cover"
                                 onerror="${imgError}"
                                 loading="lazy">
                        </div>
                        <div class="flex-1">
                            <h4 class="font-semibold text-gray-800 text-sm line-clamp-2">${item.name || 'Unknown Product'}</h4>
                            <p class="text-gray-600 text-xs">Qty: ${itemQuantity}</p>
                            <p class="text-purple-600 text-xs font-medium">${itemPrice.toLocaleString()} EGP each</p>
                        </div>
                        <div class="text-right">
                            <p class="font-bold text-purple-600">${itemTotal.toLocaleString()} EGP</p>
                            <button onclick="removeFromCheckoutCart(${index})" class="text-red-500 hover:text-red-700 text-xs mt-1 transition-colors duration-200">
                                Remove
                            </button>
                        </div>
                    </div>
                `;
                cartItemsContainer.insertAdjacentHTML('beforeend', cartItemHTML);
            });

            // Calculate and update totals
            const shipping = subtotal >= 1000 ? 0 : 50; // Free shipping over 1000 EGP
            const tax = Math.round(subtotal * 0.14); // 14% tax
            const total = subtotal + shipping + tax;

            console.log('Cart totals:', { subtotal, shipping, tax, total });

            document.getElementById('checkout-subtotal').textContent = `${subtotal.toLocaleString()} EGP`;
            document.getElementById('checkout-shipping').textContent = shipping === 0 ? 'Free' : `${shipping.toLocaleString()} EGP`;
            document.getElementById('checkout-tax').textContent = `${tax.toLocaleString()} EGP`;
            document.getElementById('checkout-total').textContent = `${total.toLocaleString()} EGP`;

            // Update cart badge in header
            updateCartUI();
            
            console.log('Cart loaded successfully with', cart.length, 'items');
        }

        // Remove item from checkout cart
        function removeFromCheckoutCart(index) {
            // Get current cart using universal function
            let cart = [];
            if (window.getCartForCheckout) {
                // Get the raw cart structure for modification
                if (window.cart && Array.isArray(window.cart)) {
                    cart = [...window.cart]; // Create a copy of global cart
                } else {
                    cart = loadGuestCartFromStorage();
                }
            } else {
                cart = loadGuestCartFromStorage();
            }
            
            if (index >= 0 && index < cart.length) {
                cart.splice(index, 1);
                
                // Update both global cart and localStorage
                if (window.cart) {
                    window.cart = cart;
                }
                localStorage.setItem('hotimpex-guest-cart', JSON.stringify(cart));
                
                // Update cart UI if CartService is available
                if (window.CartService && window.CartService.updateCartUI) {
                    window.CartService.updateCartUI();
                }
                
                loadCheckoutCart(); // Reload the cart display
                showNotification('Item removed from cart', 'info');
            }
        }

        // Test function to add sample items to cart (for debugging)
        function addTestCartItems() {
            const testItems = [
                {
                    productId: 'test-1',
                    quantity: 1,
                    productData: {
                        name: '4K UHD Generator Test Item',
                        price: 2500,
                        image: 'assets/images/Products/Av distribution/4K UHD GENRATOR.jpg',
                        currency: 'EGP'
                    }
                },
                {
                    productId: 'test-2',
                    quantity: 2,
                    productData: {
                        name: 'HDMI Cable Test Item',
                        price: 150,
                        image: 'assets/images/Products/Cable/DTECH Hdmi Cable by HOT High Speed Hdmi Cable Hdmi Male To Hdmi Male Cable Uhd 4k 3d 2160p 1 To 5m For Computer Tv Monitor V2.0.jpg',
                        currency: 'EGP'
                    }
                }
            ];
            
            // Store using consistent cart key only
            localStorage.setItem('hotimpex-guest-cart', JSON.stringify(testItems));
            loadCheckoutCart();
            showNotification('Test items added to cart', 'info');
            console.log('Test items added:', testItems);
        }

        // Add this to window for testing in console
        window.addTestCartItems = addTestCartItems;
        window.loadCheckoutCart = loadCheckoutCart;

        // Setup payment method toggle
        function setupPaymentMethodToggle() {
            const paymentOptions = document.querySelectorAll('input[name="paymentMethod"]:not([disabled])');
            const cardForm = document.getElementById('card-form');
            const codInfo = document.getElementById('cod-info');

            paymentOptions.forEach(option => {
                option.addEventListener('change', function() {
                    // Update visual selection
                    document.querySelectorAll('.payment-card').forEach(card => {
                        // Don't change disabled card styles
                        if (!card.closest('.payment-option').querySelector('input').disabled) {
                            card.classList.remove('border-green-500', 'bg-gradient-to-br', 'from-green-50', 'to-emerald-50');
                            card.classList.add('border-gray-300', 'bg-white');
                        }
                    });

                    const selectedCard = this.closest('.payment-option').querySelector('.payment-card');
                    if (!this.disabled) {
                        selectedCard.classList.remove('border-gray-300', 'bg-white');
                        selectedCard.classList.add('border-green-500', 'bg-gradient-to-br', 'from-green-50', 'to-emerald-50');
                    }

                    // Show/hide forms - card form is always hidden since it's disabled
                    if (this.value === 'card') {
                        // Card payment is disabled, so this shouldn't happen
                        // But just in case, show a message
                        showNotification('Online payment is coming soon! Please use Cash on Delivery.', 'info');
                        // Force back to COD
                        const codOption = document.querySelector('input[name="paymentMethod"][value="cod"]');
                        if (codOption) {
                            codOption.checked = true;
                            codOption.dispatchEvent(new Event('change'));
                        }
                    } else {
                        // COD selected
                        cardForm.classList.add('hidden');
                        codInfo.classList.remove('hidden');
                    }
                });
            });

            // Show notification about online payment coming soon
            setTimeout(() => {
                showNotification('Online payment will be available soon! Currently accepting Cash on Delivery orders.', 'info', 5000);
            }, 2000);
        }

        // Setup form validation
        function setupFormValidation() {
            const form = document.getElementById('checkout-form');
            const placeOrderBtn = document.getElementById('place-order-btn');

            placeOrderBtn.addEventListener('click', function() {
                if (validateForm()) {
                    processOrder();
                }
            });

            // Real-time validation
            const requiredFields = form.querySelectorAll('[required]');
            requiredFields.forEach(field => {
                field.addEventListener('blur', validateField);
                field.addEventListener('input', clearFieldError);
            });
        }

        function validateForm() {
            const form = document.getElementById('checkout-form');
            const formData = new FormData(form);
            let isValid = true;

            // Clear previous errors
            document.querySelectorAll('.error-message').forEach(error => error.remove());
            document.querySelectorAll('.border-red-500').forEach(field => {
                field.classList.remove('border-red-500');
                field.classList.add('border-gray-300');
            });

            // Validate required fields
            const requiredFields = form.querySelectorAll('[required]');
            requiredFields.forEach(field => {
                if (!field.value.trim()) {
                    showFieldError(field, 'This field is required');
                    isValid = false;
                }
            });

            // Validate email
            const email = document.getElementById('email');
            if (email.value && !isValidEmail(email.value)) {
                showFieldError(email, 'Please enter a valid email address');
                isValid = false;
            }

            // Validate phone
            const phone = document.getElementById('phone');
            if (phone.value && !isValidPhone(phone.value)) {
                showFieldError(phone, 'Please enter a valid phone number');
                isValid = false;
            }

            // Validate payment method specific fields
            const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
            if (paymentMethod === 'card') {
                // Card payment is disabled, show error and switch to COD
                //showNotification('Online payment is not available yet. Please use Cash on Delivery.', 'error');
                const codOption = document.querySelector('input[name="paymentMethod"][value="cod"]');
                if (codOption) {
                    codOption.checked = true;
                    codOption.dispatchEvent(new Event('change'));
                }
                isValid = false;
            }

            return isValid;
        }

        function validateCardFields() {
            let isValid = true;
            const cardNumber = document.getElementById('cardNumber');
            const cardExpiry = document.getElementById('cardExpiry');
            const cardCVV = document.getElementById('cardCVV');
            const cardName = document.getElementById('cardName');

            if (!cardNumber.value.replace(/\s/g, '').match(/^\d{16}$/)) {
                showFieldError(cardNumber, 'Please enter a valid 16-digit card number');
                isValid = false;
            }

            if (!cardExpiry.value.match(/^(0[1-9]|1[0-2])\/\d{2}$/)) {
                showFieldError(cardExpiry, 'Please enter expiry date in MM/YY format');
                isValid = false;
            }

            if (!cardCVV.value.match(/^\d{3,4}$/)) {
                showFieldError(cardCVV, 'Please enter a valid CVV');
                isValid = false;
            }

            if (!cardName.value.trim()) {
                showFieldError(cardName, 'Please enter the cardholder name');
                isValid = false;
            }

            return isValid;
        }

        function validateField(event) {
            const field = event.target;
            clearFieldError(field);

            if (field.hasAttribute('required') && !field.value.trim()) {
                showFieldError(field, 'This field is required');
                return false;
            }

            if (field.type === 'email' && field.value && !isValidEmail(field.value)) {
                showFieldError(field, 'Please enter a valid email address');
                return false;
            }

            if (field.type === 'tel' && field.value && !isValidPhone(field.value)) {
                showFieldError(field, 'Please enter a valid phone number');
                return false;
            }

            return true;
        }

        function showFieldError(field, message) {
            field.classList.remove('border-gray-300');
            field.classList.add('border-red-500');
            
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message text-red-500 text-sm mt-1';
            errorDiv.textContent = message;
            
            field.parentNode.insertBefore(errorDiv, field.nextSibling);
        }

        function clearFieldError(field) {
            field.classList.remove('border-red-500');
            field.classList.add('border-gray-300');
            
            const errorMessage = field.parentNode.querySelector('.error-message');
            if (errorMessage) {
                errorMessage.remove();
            }
        }

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function isValidPhone(phone) {
            return /^[\+]?[1-9][\d]{0,15}$/.test(phone.replace(/[\s\-\(\)]/g, ''));
        }

        async function processOrder() {
            const placeOrderBtn = document.getElementById('place-order-btn');
            const originalText = placeOrderBtn.innerHTML;
            
            // Show loading state
            placeOrderBtn.innerHTML = `
                <div class="flex items-center justify-center space-x-2">
                    <svg class="animate-spin w-5 h-5" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span>Processing...</span>
                </div>
            `;
            placeOrderBtn.disabled = true;

            // Collect order data
            const form = document.getElementById('checkout-form');
            const formData = new FormData(form);
            
            // Get cart using universal function for consistency
            let cart = [];
            if (window.getCartForCheckout) {
                cart = await window.getCartForCheckout();
                console.log('Order processing: Using universal cart getter with', cart);
            } else {
                // Fallback method
                cart = loadGuestCartFromStorage();
                console.log('Order processing: Using fallback method with', cart);
            }
            
            console.log('Cart for order processing:', cart);
            console.log('Cart type:', typeof cart);
            console.log('Cart is array:', Array.isArray(cart));
            
            // Ensure cart is an array
            if (!Array.isArray(cart)) {
                console.error('Cart is not an array:', cart);
                if (cart && typeof cart === 'object' && cart.items) {
                    cart = cart.items;
                } else {
                    cart = [];
                }
            }
            
            if (cart.length === 0) {
                showNotification('Your cart is empty', 'error');
                placeOrderBtn.innerHTML = originalText;
                placeOrderBtn.disabled = false;
                return;
            }
            
            const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
            const user = window.AuthService ? window.AuthService.getUser() : null;
            
            console.log('Payment method found:', paymentMethod);
            console.log('User:', user);
            
            // Calculate totals
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const shipping = subtotal >= 1000 ? 0 : 50;
            const tax = Math.round(subtotal * 0.14);
            const total = subtotal + shipping + tax;

            // Format order data to match backend expectations
            const orderData = {
                cart: cart.map(item => ({
                    id: item.productId || item.id,
                    name: item.productData?.name || item.name,
                    price: item.productData?.price || item.price,
                    quantity: item.quantity,
                    image: item.productData?.image || item.image
                })),
                customerInfo: {
                    name: `${formData.get('firstName')} ${formData.get('lastName')}`,
                    email: formData.get('email'),
                    phone: formData.get('phone'),
                    address: `${formData.get('address')}, ${formData.get('city')}, ${formData.get('state')} ${formData.get('zipCode')}, ${formData.get('country')}`,
                    notes: formData.get('notes') || ''
                },
                paymentMethod: paymentMethod, // Make sure this is at top level
                userId: user ? user._id : null,
                subtotal: subtotal,
                shippingCost: shipping,
                tax: tax,
                total: total
            };

            console.log('=== FRONTEND ORDER DATA DEBUG ===');
            console.log('Payment method variable:', paymentMethod);
            console.log('Complete order data:', JSON.stringify(orderData, null, 2));
            console.log('================================');

            // Submit order to backend
            try {
                const response = await submitOrder(orderData);
                
                if (response.success) {
                    // Generate order number
                    const orderNumber = response.orderNumber || '#HOT' + Date.now();
                    document.getElementById('order-number').textContent = orderNumber;
                    
                    // Clear cart from all possible keys and update UI
                    localStorage.removeItem('hotimpex-guest-cart');
                    localStorage.removeItem('hotimpex-cart');
                    localStorage.removeItem('hotimpex_cart');
                    
                    // Clear global cart if available
                    if (window.cart) {
                        window.cart = [];
                    }
                    
                    // Update cart UI if CartService is available
                    if (window.CartService && window.CartService.updateCartUI) {
                        window.CartService.updateCartUI();
                    }
                    
                    // Update cart badge manually
                    const cartBadge = document.getElementById('cart-badge');
                    if (cartBadge) {
                        cartBadge.style.display = 'none';
                        cartBadge.textContent = '0';
                    }
                    
                    // Update user profile if they're logged in and profile data changed
                    if (user) {
                        const [firstName, ...lastNameParts] = orderData.customerInfo.name.split(' ');
                        const lastName = lastNameParts.join(' ');
                        await updateUserProfile({
                            firstName: firstName,
                            lastName: lastName,
                            phone: orderData.customerInfo.phone
                        }, {
                            address: orderData.customerInfo.address
                        });
                    }
                    
                    // Show success modal
                    showSuccessModal();
                    
                    showNotification('Order placed successfully!', 'success');
                } else {
                    throw new Error(response.message || 'Order processing failed');
                }
            } catch (error) {
                console.error('Order processing error:', error);
                showNotification('Failed to process order. Please try again.', 'error');
                
                // Reset button on error
                placeOrderBtn.innerHTML = originalText;
                placeOrderBtn.disabled = false;
            }
        }

        // Submit order to backend
        async function submitOrder(orderData) {
            try {
                console.log('Submitting order:', orderData);
                
                // Prepare data for API
                const response = await fetch('/api/orders', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        ...(window.AuthService && window.AuthService.getToken() ? {
                            'Authorization': `Bearer ${window.AuthService.getToken()}`
                        } : {})
                    },
                    body: JSON.stringify(orderData)
                });

                const result = await response.json();
                
                if (!response.ok) {
                    throw new Error(result.message || `HTTP error! status: ${response.status}`);
                }

                console.log('Order created successfully:', result);
                
                return {
                    success: true,
                    orderNumber: result.data.orderNumber || result.data.order.orderNumber,
                    orderId: result.data.order.id,
                    message: 'Order placed successfully'
                };
            } catch (error) {
                console.error('API Error submitting order:', error);
                return {
                    success: false,
                    message: error.message || 'Failed to submit order'
                };
            }
        }

        // Update user profile with latest information
        async function updateUserProfile(customerData, addressData) {
            try {
                const user = AuthService.getUser();
                if (!user) return;

                const updatedUser = {
                    ...user,
                    firstName: customerData.firstName,
                    lastName: customerData.lastName,
                    phone: customerData.phone,
                    address: addressData.address,
                    city: addressData.city,
                    state: addressData.state,
                    zipCode: addressData.zipCode,
                    country: addressData.country
                };

                // Update local storage
                AuthService.setUser(updatedUser);
                
                // Here you would also send the update to the backend
                // await APIService.request('/users/profile', {
                //     method: 'PUT',
                //     body: JSON.stringify(updatedUser),
                //     headers: { 'Authorization': `Bearer ${AuthService.getToken()}` }
                // });
                
                console.log('User profile updated with order information');
            } catch (error) {
                console.error('Error updating user profile:', error);
            }
        }

        function showSuccessModal() {
            const modal = document.getElementById('success-modal');
            modal.classList.remove('hidden');
            modal.querySelector('.bg-white').classList.remove('scale-95');
            modal.querySelector('.bg-white').classList.add('scale-100');
        }

        function closeSuccessModal() {
            const modal = document.getElementById('success-modal');
            modal.querySelector('.bg-white').classList.remove('scale-100');
            modal.querySelector('.bg-white').classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
                window.location.href = 'shop.html';
            }, 300);
        }

        // Setup mobile menu
        function setupMobileMenu() {
            const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');
            const mobileMenuClose = document.getElementById('mobile-menu-close');
            const mobileMenuBackdrop = document.getElementById('mobile-menu-backdrop');

            if (mobileMenuToggle) {
                mobileMenuToggle.addEventListener('click', () => {
                    mobileMenu.classList.remove('hidden');
                });
            }

            if (mobileMenuClose) {
                mobileMenuClose.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            }

            if (mobileMenuBackdrop) {
                mobileMenuBackdrop.addEventListener('click', () => {
                    mobileMenu.classList.add('hidden');
                });
            }
        }

        // Setup theme toggle
        function setupThemeToggle() {
            const themeToggle = document.getElementById('theme-toggle');
            if (themeToggle) {
                themeToggle.addEventListener('click', () => {
                    document.documentElement.classList.toggle('dark');
                    const isDark = document.documentElement.classList.contains('dark');
                    localStorage.setItem('darkMode', isDark);
                });
            }
        }

        // Format card number input
        document.addEventListener('DOMContentLoaded', function() {
            const cardNumberInput = document.getElementById('cardNumber');
            if (cardNumberInput) {
                cardNumberInput.addEventListener('input', function() {
                    let value = this.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
                    let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
                    this.value = formattedValue;
                });
            }

            const cardExpiryInput = document.getElementById('cardExpiry');
            if (cardExpiryInput) {
                cardExpiryInput.addEventListener('input', function() {
                    let value = this.value.replace(/\D/g, '');
                    if (value.length >= 2) {
                        value = value.substring(0, 2) + '/' + value.substring(2, 4);
                    }
                    this.value = value;
                });
            }

            const cardCVVInput = document.getElementById('cardCVV');
            if (cardCVVInput) {
                cardCVVInput.addEventListener('input', function() {
                    this.value = this.value.replace(/\D/g, '').substring(0, 4);
                });
            }
        });

        // Notification system
        function showNotification(message, type = 'info', duration = 3000) {
            const container = document.getElementById('notification-container');
            if (!container) return;

            const notification = document.createElement('div');
            notification.className = `notification bg-white border-l-4 rounded-lg shadow-lg p-4 mb-4 transform translate-x-full transition-transform duration-300 ${getNotificationColors(type)}`;
            
            notification.innerHTML = `
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        ${getNotificationIcon(type)}
                    </div>
                    <div class="ml-3">
                        <p class="text-sm font-medium text-gray-800">${message}</p>
                    </div>
                    <div class="ml-auto pl-3">
                        <button onclick="this.parentElement.parentElement.parentElement.remove()" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            `;

            container.appendChild(notification);

            // Animate in
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
            }, 100);

            // Auto remove
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => {
                    if (notification.parentElement) {
                        notification.remove();
                    }
                }, 300);
            }, duration);
        }

        function getNotificationColors(type) {
            switch (type) {
                case 'success': return 'border-green-500';
                case 'error': return 'border-red-500';
                case 'warning': return 'border-yellow-500';
                default: return 'border-blue-500';
            }
        }

        function getNotificationIcon(type) {
            const iconClass = "w-5 h-5";
            switch (type) {
                case 'success':
                    return `<svg class="${iconClass} text-green-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>`;
                case 'error':
                    return `<svg class="${iconClass} text-red-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path>
                    </svg>`;
                case 'warning':
                    return `<svg class="${iconClass} text-yellow-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                    </svg>`;
                default:
                    return `<svg class="${iconClass} text-blue-500" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                    </svg>`;
            }
        }
    </script>

    <!-- Cart Sidebar -->
    <div id="cart-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
    <div id="cart-sidebar" class="fixed top-4 right-0 h-[calc(100vh-2rem)] w-[450px] bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg shadow-2xl z-50 transform translate-x-full transition-transform duration-500 ease-in-out border border-white/20 rounded-l-2xl">
        <div class="flex flex-col h-full">
            <!-- Header -->
            <div class="flex items-center justify-between p-6 border-b border-gray-200/10 flex-shrink-0">
                <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Shopping Cart</h2>
                <button id="close-cart" class="p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-200/50 dark:hover:bg-gray-700/50 transition-colors">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>

            <!-- Cart Items -->
            <div class="flex-1 overflow-y-auto p-6 space-y-6">
                <div id="cart-items">
                    <!-- Empty Cart Message -->
                    <div class="text-center text-gray-500 dark:text-gray-400 py-16">
                        <svg class="w-24 h-24 mx-auto text-gray-300 dark:text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                        </svg>
                        <p class="mt-4 text-lg font-semibold">Your cart is empty</p>
                        <p class="mt-2 text-sm">Add items to see them here.</p>
                    </div>
                    <!-- Cart items will be dynamically added here -->
                </div>
            </div>

            <!-- Footer -->
            <div class="border-t border-gray-200/10 p-6 flex-shrink-0">
                <div class="flex items-center justify-between mb-4">
                    <span class="text-lg font-semibold text-gray-800 dark:text-white">Subtotal:</span>
                    <span id="cart-total" class="text-2xl font-bold text-purple-600 dark:text-purple-400">0 EGP</span>
                </div>
                <button onclick="window.location.href='checkout.html'" class="w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white py-4 px-6 rounded-xl hover:from-purple-700 hover:to-pink-700 transition-all duration-300 transform hover:scale-105 focus:outline-none focus:ring-4 focus:ring-purple-300 dark:focus:ring-purple-800 font-bold text-lg">
                    Proceed to Checkout
                </button>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notification-container" class="fixed bottom-4 right-4 z-50"></div>
</body>
</html>
